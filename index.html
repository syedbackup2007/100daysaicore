<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ”¥ 100 Day AI Elite</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Outfit',sans-serif;}
body{
  background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);
  color:#fff;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.container{width:95%;max-width:430px;}
.card{
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(20px);
  border-radius:24px;
  padding:22px;
  margin-bottom:18px;
  box-shadow:0 10px 40px rgba(0,0,0,0.4);
  transition:0.3s;
}
.card:hover{transform:translateY(-6px);}
h1{text-align:center;margin-bottom:20px;font-size:26px;}
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:linear-gradient(90deg,#ff00cc,#3333ff);
  color:#fff;
  font-weight:600;
  margin-top:14px;
  cursor:pointer;
  transition:0.3s;
}
button:hover{transform:scale(1.05);}
progress{width:100%;height:10px;margin-top:10px;}
.small{font-size:14px;opacity:0.9;margin-top:8px;}
.stat{font-size:14px;margin-top:6px;}
.level{font-weight:700;color:#ffccff;}
.xpText{margin-top:6px;font-size:13px;opacity:0.8;}
</style>
</head>

<body>
<div class="container">

<h1>ðŸ”¥ 100 Day AI Elite</h1>

<div class="card">
  <h2 id="day"></h2>
  <p id="task" class="small">Complete today's mission.</p>
  <button id="completeBtn">Complete Day</button>
  <p id="motivation" class="small"></p>
</div>

<div class="card">
  <div class="stat">Level: <span id="level" class="level"></span></div>
  <div class="xpText">XP: <span id="xp"></span></div>
  <progress id="xpBar" max="100" value="0"></progress>
</div>

<div class="card">
  <div class="stat">ðŸ”¥ Streak: <span id="streak"></span></div>
  <div class="stat">ðŸ’ª Discipline: <span id="discipline"></span></div>
  <div class="stat">ðŸŽ¯ Focus: <span id="focus"></span></div>
  <div class="stat">âš¡ Consistency: <span id="consistency"></span></div>
</div>

</div>

<script>

const dayEl=document.getElementById("day");
const taskEl=document.getElementById("task");
const motivationEl=document.getElementById("motivation");
const completeBtn=document.getElementById("completeBtn");

const xpEl=document.getElementById("xp");
const xpBar=document.getElementById("xpBar");
const levelEl=document.getElementById("level");
const streakEl=document.getElementById("streak");

const disciplineEl=document.getElementById("discipline");
const focusEl=document.getElementById("focus");
const consistencyEl=document.getElementById("consistency");

/* DATA SYSTEM */
function getData(){
  let data=JSON.parse(localStorage.getItem("eliteApp"));
  if(!data){
    data={
      currentDay:1,
      streak:0,
      lastComplete:0,
      xp:0,
      level:1,
      discipline:0,
      focus:0,
      consistency:0
    };
    localStorage.setItem("eliteApp",JSON.stringify(data));
  }
  return data;
}

function saveData(data){
  localStorage.setItem("eliteApp",JSON.stringify(data));
}

function getLevelName(level){
  if(level<3) return "Rookie";
  if(level<6) return "Builder";
  if(level<10) return "Beast";
  return "Elite";
}

function updateUI(data){
  dayEl.innerText="Day "+data.currentDay;
  streakEl.innerText=data.streak;

  xpEl.innerText=data.xp;
  xpBar.value=data.xp % 100;
  levelEl.innerText=getLevelName(data.level)+" (Lv."+data.level+")";

  disciplineEl.innerText=data.discipline;
  focusEl.innerText=data.focus;
  consistencyEl.innerText=data.consistency;
}

updateUI(getData());

/* COMPLETE DAY */
completeBtn.onclick=async()=>{
  let data=getData();
  const now=Date.now();
  const diff=now-data.lastComplete;

  if(diff<86400000){
    alert("â³ Come back tomorrow.");
    return;
  }

  let newStreak=data.streak;
  if(diff>172800000) newStreak=0;

  data.currentDay+=1;
  data.streak=newStreak+1;
  data.lastComplete=now;

  const gainedXP=25+Math.floor(Math.random()*15);
  data.xp+=gainedXP;

  if(data.xp>=data.level*100){
    data.level+=1;
  }

  data.discipline+=2;
  data.focus+=2;
  data.consistency+=3;

  saveData(data);
  updateUI(data);

  getAIMessage(data.currentDay,data.streak);
};

/* AI */
async function getAIMessage(day,streak){
  try{
    const res=await fetch("/.netlify/functions/ai",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({day,streak})
    });

    const data=await res.json();

    taskEl.innerText=data.task;
    motivationEl.innerText="ðŸ”¥ "+data.motivation;

  }catch{
    taskEl.innerText="Do 30 minutes of deep focused work.";
    motivationEl.innerText="Consistency builds empires.";
  }
}

/* SERVICE WORKER */
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("sw.js");
}

</script>

</body>
</html>
