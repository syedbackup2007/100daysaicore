<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ”¥ 100 Day AI Elite</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Outfit',sans-serif;
}

body{
  background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);
  color:#fff;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.container{
  width:95%;
  max-width:420px;
}

.card{
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(20px);
  border-radius:24px;
  padding:25px;
  margin-bottom:20px;
  box-shadow:0 10px 40px rgba(0,0,0,0.4);
  transition:0.3s ease;
}

.card:hover{
  transform:translateY(-6px);
}

h1{
  text-align:center;
  margin-bottom:25px;
  font-weight:700;
  font-size:26px;
}

h2{
  font-weight:600;
  margin-bottom:10px;
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:linear-gradient(90deg,#ff00cc,#3333ff);
  color:#fff;
  font-weight:600;
  margin-top:15px;
  cursor:pointer;
  transition:0.3s ease;
  font-size:15px;
}

button:hover{
  transform:scale(1.05);
}

.secondary{
  background:rgba(255,255,255,0.15);
}

progress{
  width:100%;
  height:10px;
  border-radius:10px;
  overflow:hidden;
}

progress::-webkit-progress-bar{
  background:#222;
}

progress::-webkit-progress-value{
  background:linear-gradient(90deg,#ff00cc,#3333ff);
}

.small{
  font-size:14px;
  opacity:0.8;
  margin-top:8px;
}

.ai{
  margin-top:12px;
  font-size:14px;
  opacity:0.9;
  color:#ffccff;
}
</style>
</head>

<body>

<div class="container">

<h1>ðŸ”¥ 100 Day AI Elite</h1>

<div class="card">
  <h2 id="day"></h2>
  <p id="task" class="small">Complete today's mission.</p>
  <button id="completeBtn">Complete Day</button>
  <p id="aiMessage" class="ai"></p>
</div>

<div class="card">
  <h2 id="streak"></h2>
  <progress id="progressBar" max="100" value="1"></progress>
</div>

<div class="card">
  <button onclick="enableVoice()" class="secondary">Enable Voice</button>
  <button onclick="requestNotifications()" class="secondary">Enable Notifications</button>
</div>

</div>

<script>

const day = document.getElementById("day");
const streak = document.getElementById("streak");
const progressBar = document.getElementById("progressBar");
const completeBtn = document.getElementById("completeBtn");
const task = document.getElementById("task");
const aiMessage = document.getElementById("aiMessage");

let voiceEnabled = false;

function getData(){
  let data = JSON.parse(localStorage.getItem("aiElite"));
  if(!data){
    data = { currentDay:1, streak:0, lastComplete:0 };
    localStorage.setItem("aiElite",JSON.stringify(data));
  }
  return data;
}

function saveData(data){
  localStorage.setItem("aiElite",JSON.stringify(data));
}

function updateUI(data){
  day.innerText="Day "+data.currentDay;
  streak.innerText="ðŸ”¥ Streak: "+data.streak;
  progressBar.value=data.currentDay;
}

updateUI(getData());

completeBtn.onclick=()=>{
  let data=getData();
  const now=Date.now();
  const diff=now-data.lastComplete;

  if(diff<86400000){
    alert("â³ Come back tomorrow!");
    return;
  }

  let newStreak=data.streak;
  if(diff>172800000) newStreak=0;

  data.currentDay+=1;
  data.streak=newStreak+1;
  data.lastComplete=now;

  saveData(data);
  updateUI(data);
  getAIMessage(data.currentDay);
};

async function getAIMessage(day){
  try{
    const res=await fetch("/.netlify/functions/ai",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({
        prompt:`Generate task + motivation for day ${day}`
      })
    });

    const data=await res.json();
    task.innerText=data.reply;
    aiMessage.innerText="ðŸ”¥ AI says: Keep building!";
    if(voiceEnabled) speak(data.reply);
  }catch{
    task.innerText="AI unavailable. Stay consistent.";
  }
}

window.enableVoice=()=> voiceEnabled=true;

function speak(text){
  const utter=new SpeechSynthesisUtterance(text);
  speechSynthesis.speak(utter);
}

window.requestNotifications=async()=>{
  await Notification.requestPermission();
  new Notification("Challenge Activated ðŸ”¥");
};

if("serviceWorker" in navigator){
  navigator.serviceWorker.register("sw.js");
}

</script>

</body>
</html>
